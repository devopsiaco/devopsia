<!-- /docs/components/sidebar.html -->
<aside class="w-full md:w-64 shrink-0 border-r bg-white/90 backdrop-blur sticky top-0 md:h-screen">
  <div class="p-4 flex items-center gap-3 border-b">
    <img id="sidebar-avatar" alt="Avatar" class="w-10 h-10 rounded-full object-cover border" src="data:image/svg+xml,%3Csvg%20xmlns%3D%27http%3A//www.w3.org/2000/svg%27%20width%3D%27128%27%20height%3D%27128%27%20viewBox%3D%270%200%20128%20128%27%3E%3Crect%20width%3D%27128%27%20height%3D%27128%27%20fill%3D%27%23e5e7eb%27/%3E%3C/svg%3E">
    <div class="min-w-0">
      <div id="sidebar-user-email" class="text-sm font-medium truncate">Loading...</div>
      <div id="sidebar-user-plan" class="text-xs text-gray-500">—</div>
    </div>
  </div>
  <nav class="p-2">
    <a href="/" class="sidebar-link block px-3 py-2 rounded-lg hover:bg-gray-100" data-id="home">Home</a>
    <!-- Collapsible AI Assistant group -->
    <div class="mt-1">
      <button id="ai-assistant-toggle" class="w-full flex items-center justify-between px-3 py-2 rounded-lg hover:bg-gray-100">
        <span class="font-medium">AI Assistant</span>
        <span id="ai-assistant-caret" aria-hidden="true">▸</span>
      </button>
      <div id="ai-assistant-group" class="ml-3 mt-1 hidden">
        <a href="/ai-assistant/" class="sidebar-sublink block px-3 py-2 rounded-lg hover:bg-gray-100" data-id="assistant-root">Overview</a>
        <a href="/ai-assistant-terraform/" class="sidebar-sublink block px-3 py-2 rounded-lg hover:bg-gray-100" data-id="assistant-terraform">Terraform</a>
        <a href="/ai-assistant-ansible/" class="sidebar-sublink block px-3 py-2 rounded-lg hover:bg-gray-100" data-id="assistant-ansible">Ansible</a>
        <a href="/ai-assistant-k8s/" class="sidebar-sublink block px-3 py-2 rounded-lg hover:bg-gray-100" data-id="assistant-k8s">Kubernetes</a>
        <a href="/ai-assistant-helm/" class="sidebar-sublink block px-3 py-2 rounded-lg hover:bg-gray-100" data-id="assistant-helm">Helm</a>
        <a href="/ai-assistant-yaml/" class="sidebar-sublink block px-3 py-2 rounded-lg hover:bg-gray-100" data-id="assistant-yaml">YAML</a>
        <a href="/ai-assistant-docker/" class="sidebar-sublink block px-3 py-2 rounded-lg hover:bg-gray-100" data-id="assistant-docker">Docker</a>
      </div>
    </div>
    <a href="/prompt-history/" class="sidebar-link block px-3 py-2 rounded-lg hover:bg-gray-100 mt-1" data-id="prompt-history">Prompt History</a>
    <a href="/user-account/" class="sidebar-link block px-3 py-2 rounded-lg hover:bg-gray-100 mt-1" data-id="user-account">User Account</a>
    <button id="sidebar-logout" class="w-full mt-2 px-3 py-2 text-left rounded-lg hover:bg-gray-100">Logout</button>
  </nav>
</aside>
<script>
  // Sidebar behavior
  (function() {
    const caret = document.getElementById('ai-assistant-caret');
    const group = document.getElementById('ai-assistant-group');
    const toggle = document.getElementById('ai-assistant-toggle');
    const saved = localStorage.getItem('nav.ai.open') === '1';
    if (saved) { group.classList.remove('hidden'); caret.textContent = '▾'; }
    toggle?.addEventListener('click', () => {
      const isHidden = group.classList.contains('hidden');
      group.classList.toggle('hidden');
      caret.textContent = isHidden ? '▾' : '▸';
      localStorage.setItem('nav.ai.open', isHidden ? '1' : '0');
    });
    // Logout
    document.getElementById('sidebar-logout')?.addEventListener('click', async () => {
      try { await firebase.auth().signOut(); window.location.href = '/login/'; } catch (e) { console.error(e); }
    });
  })();
</script>
<style>
  .sidebar-link.active, .sidebar-sublink.active { background-color: rgba(16,185,129,0.12); }
</style>
